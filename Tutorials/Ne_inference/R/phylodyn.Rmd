---
title: "BNPR"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Hepatitis C virus in Egypt
We can visualize the MCCT as follows:

```{R}
library("ape")
mcct<-"~/Documents/sismid/SISMID/Tutorials/Ne_estimation/precooked_runs/hcv_mcct"
tree<-read.nexus(mcct)
plot(tree,show.tip.label = FALSE)
```


You can estimate the effective population size from a fixed tree as follows:

```{r plotting}
#install.packages("INLA", repos=c(getOption("repos"), INLA="https://inla.r-inla-download.org/R/stable"), dep=TRUE)
#library(devtools)
#install_github("mdkarcher/phylodyn")
library("phylodyn")
bnpr_estimate<-BNPR(tree,prec_alpha=10.0)
plot_BNPR(bnpr_estimate)
```


More tutorials: [phylodyn](https://github.com/mdkarcher/phylodyn)

Reference: Karcher, MD, Palacios JA, Lan S, and Minin, VN. 
phylodyn: an R package for phylodynamic simulation and inference. *Molecular Ecology Resources* 2017.

